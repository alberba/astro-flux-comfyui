---
interface Props {
  id: string;
  accept?: string;
  onUpload?: (file: File) => void;
}

const { id, accept = "image/*", onUpload } = Astro.props;
---

<button
  type="button"
  class="px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500"
  onclick={`document.getElementById('${id}').click()`}
>
  Selecciona un archivo
</button>
<input
  type="file"
  id={id}
  accept={accept}
  class="hidden"
/>

<script define:vars={{ id }}>
  const fileInput = document.getElementById(id) as HTMLInputElement;
  
  fileInput?.addEventListener('change', (e) => {
    const files = (e.target as HTMLInputElement).files;
    if (files && files.length > 0) {
      const event = new CustomEvent('file-upload', { detail: files[0] });
      window.dispatchEvent(event);
    }
  });
</script> 