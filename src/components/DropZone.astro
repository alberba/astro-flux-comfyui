---
interface Props {
  id: string;
}

const { id } = Astro.props;
---

<div id="dropZone">
  <div
    id="container"
    class="relative w-full aspect-[3/2] border-2 border-dashed border-gray-300 rounded-lg bg-gray-50 flex flex-col items-center justify-center cursor-pointer hover:border-indigo-500 transition-colors">
    <div id={`content`} class="text-center p-4">
      <svg
        class="mx-auto h-12 w-12 text-gray-400"
        stroke="currentColor"
        fill="none"
        viewBox="0 0 48 48">
        <path
          d="M28 8H12a4 4 0 00-4 4v20m32-12v8m0 0v8a4 4 0 01-4 4H12a4 4 0 01-4-4v-4m32-4l-3.172-3.172a4 4 0 00-5.656 0L28 28M8 32l9.172-9.172a4 4 0 015.656 0L28 28m0 0l4 4m4-24h8m-4-4v8m-12 4h.02"
          stroke-width="2"
          stroke-linecap="round"
          stroke-linejoin="round"></path>
      </svg>
      <p class="mt-2 text-sm text-gray-600">
        Arrastra y suelta tu imagen aquí, o
      </p>
      <button
        type="button"
        class="px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500"
        onclick={`document.getElementById('fileupload').click()`}>
        Selecciona un archivo
      </button>
      <input
        type="file"
        id="fileupload"
        accept="image/*"
        class="hidden"
        multiple
      />
    </div>
    <canvas id="canvas" class="hidden w-full"></canvas>
  </div>
  <div class="flex flex-col gap-2 my-2 items-center">
    <div class="items-center gap-2 hidden flex-row w-2/3" id="maskSettings">
      <div class="flex gap-2">
        <button
          id="blackMask"
          class="w-8 h-8 rounded-full bg-black border-2 border-gray-300 hover:border-indigo-500 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500"
          title="Máscara negra"></button>
        <button
          id="whiteMask"
          class="w-8 h-8 rounded-full bg-white border-2 border-gray-300 hover:border-indigo-500 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-500"
          title="Máscara blanca"></button>
      </div>
      <div class="flex flex-col gap-2 w-full">
        <label class="block text-sm font-medium text-gray-700 mb-0.5"
          >Grosor del pincel</label
        >
        <input
          type="range"
          id="brushSize"
          min="5"
          max="200"
          value="10"
          class="h-2 w-full bg-gray-200 rounded-lg appearance-none cursor-pointer"
        />
        <span id="brushSizeValue" class="block text-sm text-gray-600 mt-1"
          >10</span
        >
      </div>
    </div>
    <button
      id="clearMask"
      class="bg-red-500 text-white py-2 px-16 rounded hover:bg-red-600 hidden">
      Limpiar Máscara
    </button>
  </div>
</div>

<script type="module">
  import { CanvasHandler } from "../lib/canvasHandler.ts";

  document.addEventListener("DOMContentLoaded", () => {
    // Initialize CanvasHandler
    new CanvasHandler("canvas", "dropZone", "fileupload", "container");
  });
</script>
